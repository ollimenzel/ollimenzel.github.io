[{"content":"When copying pages with language variations using ShareGate, you may encounter an issue where the Pages for the different languages are not properly connected to each other. This results in the variations not being displayed correctly on the site.\nTo fix this issue, you can use PowerShell to reconnect the pages with their language variations. In this blog post, we\u0026rsquo;ll walk through the PowerShell code for doing this.\nStep-by-Step Explanation of the Code Here\u0026rsquo;s a step-by-step explanation of the PowerShell code for reconnecting pages with language variations after copying them with ShareGate:\nFirst, we need to connect to the SharePoint site where the pages are located. We can do this using the Connect-PnPOnline cmdlet: 1 Connect-PnPOnline -Url \u0026#34;https://contoso.sharepoint.com/sites/MySite\u0026#34; Next, we need to get a list of all the pages in the site. We can do this using the Get-PnPFolderItem cmdlet with the right language folder: 1 $Files = Get-PnPFolderItem -FolderSiteRelativeUrl SitePages/de This code gets a list of all the pages in the \u0026ldquo;Site Pages\u0026rdquo; language folder.\nNow that we have a list of all the pages, we need to loop through each page and reconnect its language variations. We can do this using a foreach loop: 1 2 3 foreach ($Page in $Pages) { # Reconnect language variations for the page } Inside the foreach loop, we need to get the default file for the page. We can do this using the Get-PnPFile cmdlet: 1 $DefaultFile = Get-PnPFile -Url \u0026#34;SitePages/$($Page.Name)\u0026#34; -AsListItem This code gets the default Page by using the Name property from the $Page object.\nNext, we need to get additional informations from the language variations of the page. We can do this using the Get-PnPListItem cmdlet: 1 $LangFile = Get-PnPFile -Url SitePages/$Language/$($Page.Name) -AsListItem This code gets a information about language variations page by filtering the pages in the \u0026ldquo;Site Pages\u0026rdquo; library by Folder $Language-Variable and the $Page.Name.\nNow that we have all the information we need, we can reconnect the language variations to the default file. We can do this using the Set-PnPListItem cmdlet: 1 2 #Set the Default Item field Set-PnPListItem -List SitePages -Identity $DefaultFile.Id -Values @{\u0026#34;_SPTranslatedLanguages\u0026#34; = $LangISO} 1 2 #Set the Language Item fields Set-PnPListItem -List SitePages -Identity $LangFile.Id -Values @{\u0026#39;_SPIsTranslation\u0026#39; = \u0026#39;1\u0026#39;; \u0026#39;_SPTranslationLanguage\u0026#39; = $LangISO; \u0026#39;_SPTranslationSourceItemId\u0026#39; = $DefaultFile.FieldValues.UniqueId } This code sets the _SPTranslationSourceItemId property of the variation file to the GUID of the default file.\nThat\u0026rsquo;s it! We\u0026rsquo;ve now looped through all the pages and their language variations, and reconnected them to each other. Conclusion In this blog post, we\u0026rsquo;ve walked through the PowerShell code for reconnecting pages with language variations after copying them with ShareGate. By using this code, you can ensure that the language variations are properly connected to each other, and that they are displayed correctly on the site.\nHere\u0026rsquo;s the complete PowerShell script for reconnecting pages with language variations after copying them with ShareGate:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $SiteCollection = \u0026#34;https://contoso.sharepoint.com/sites/SiteCollection\u0026#34; $Language = \u0026#34;de\u0026#34; $LangISO = \u0026#34;de-de\u0026#34; #Create Connection Connect-PnPOnline -Url $SiteCollection -Interactive #Get all aspx pages within Folder DE in Library SitePages $Pages = Get-PnPFolderItem -FolderSiteRelativeUrl SitePages/$Language #Loop through all files and get the file object from the files with the same name in the root directory foreach ($Page in $Pages) { $DefaultFile = Get-PnPFile -Url SitePages/$($Page.Name) -AsListItem $LangFile = Get-PnPFile -Url SitePages/$Language/$($Page.Name) -AsListItem #Set the Default Item field Set-PnPListItem -List SitePages -Identity $DefaultFile.Id -Values @{\u0026#34;_SPTranslatedLanguages\u0026#34; = $LangISO} #Set the German Language Item fields Set-PnPListItem -List SitePages -Identity $LangFile.Id -Values @{\u0026#39;_SPIsTranslation\u0026#39; = \u0026#39;1\u0026#39;; \u0026#39;_SPTranslationLanguage\u0026#39; = $LangISO; \u0026#39;_SPTranslationSourceItemId\u0026#39; = $DefaultFile.FieldValues.UniqueId } } ","date":"2023-07-27T11:57:41+02:00","image":"https://www.menzel.it/post/2023/07/disable_sharing/Reconnect_hu58e59d2a09840853c5e0830e43305ea7_1183462_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/07/disable_sharing/","title":"Reconnecting Pages with Language Variations After Copying Them with ShareGate"},{"content":"Simplifying File Management with OneDrive: Add to OneDrive vs. Team Site Sync\nOneDrive offers convenient file management and collaboration features, including Add to OneDrive and Team Site Sync. These tools streamline access to shared files and folders, enhancing productivity. Let\u0026rsquo;s explore their benefits and compare them.\nAdd to OneDrive: Easy File Access Add to OneDrive lets you bring shared files into your personal OneDrive space without moving them physically. Simply locate the desired folder, select the Folders tile, and choose \u0026ldquo;Add Shortcut to My Files.\u0026rdquo; This creates a shortcut for quick access.\nThis feature is particularly useful for accessing files across devices related to collaborative projects. It provides centralized access regardless of your location, improving efficiency and reducing clicks.\nTeam Site Sync: Comprehensive File Synchronization Team Site Sync also allows you syncing files from OneDrive, SharePoint, and Teams.\nTeam Site Sync syncs specific folders or libraries, but it is limited to the device where synchronization occurred.\nChoosing Between Add to OneDrive and Team Site Sync For most scenarios, Add to OneDrive is recommended due to its enhanced capabilities and future development. If your organization isn\u0026rsquo;t extensively using Team Site Sync, it\u0026rsquo;s advisable to prioritize Add to OneDrive exclusively.\nIf your organization currently employs both features, Microsoft plans to provide guidance on migrating from Team Site Sync to Add to OneDrive gradually.\nDisabling the Sync Button To streamline the file synchronization experience and promote Add to OneDrive, you can disable the sync button for the entire site using the following code:\n1 Set-SPOTenant -HideSyncButtonOnTeamSite $true This script helps IT administrators guide users towards Add to OneDrive and encourages its adoption.\n","date":"2023-05-16T16:38:45+02:00","image":"https://www.menzel.it/post/2023/05/add_to_onedrive/Main_hu502c155179e040f10273bd58ace348bd_299354_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/05/add_to_onedrive/","title":"Simplifying File Management with OneDrive: Add to OneDrive vs. Team Site Sync"},{"content":"SharePoint Online is a powerful collaboration tool that allows users to share documents and collaborate with others. However, sometimes you may want to restrict sharing permissions for non-owners of a document. In this post, we\u0026rsquo;ll show you how to disable sharing for non-owners in SharePoint Online.\nSteps to Disable Sharing for Non-Owners Open the SharePoint Online site where you want to disable sharing for non-owners. Click on the gear icon in the top right corner and select \u0026ldquo;Site Settings\u0026rdquo;. Under \u0026ldquo;Site Permissions\u0026rdquo;, click on \u0026ldquo;Advanced permission settings\u0026rdquo;. In the ribbon choose the \u0026ldquo;Access Request Settings\u0026rdquo;. Uncheck \u0026ldquo;Allow members to share the site and individual files and folders\u0026rdquo; to restrict sharing permissions for non-owners of a document. That\u0026rsquo;s it! Now you know how to disable sharing for non-owners in SharePoint Online. If you have any questions or comments, please leave them below. ","date":"2023-05-11T00:00:00Z","image":"https://www.menzel.it/post/2023/05/disable_sharing/Microsoft365-Logo_huc751c11c8412c46ecd89393641f090d6_5832667_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/05/disable_sharing/","title":"How to Disable Sharing for Non-Owners in SharePoint Online"}]