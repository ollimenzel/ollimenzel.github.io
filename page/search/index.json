[{"content":"Prerequisites For this tutorial you need the following:\nA premium Power Automate account, e.g. a Power Automate per user plan or an Powerapps Comunity Plan A Social Media Account, e.g. Twitter, Mastodon, LinkedIn, etc. The Flows from one of my previous posts Power Automate - How-to Posting on BlueSky and Mastodon Create AI Prompt in Power Platform Go to Power Automate\nClick on AI hub in the left navigation Choose AI Prompts Click on Create text using custom prompt Choose Custom task with custom prompts and click on Create custom prompt Enter a name for your AI Prompt\nEnter your prompt (here is what I used for my prompt)\nAs an expert in social media, create me witty posts for my social networks (Bluesky and Mastodon) with meaningful hashtags (Microsoft centric) about my newest Blog post that you can find here: [Dynamic Value BlogURL] . Also please take the lowest character count into consideration for the two networks. Also create another post for LinkedIn that can be a bit longer. Please create the posts in a way that will make my followers want to know more about the blog post e.g. with examples or some insides. Please also don\u0026rsquo;t add any BlogURL. Please just response the post without any explanations. but in the following format: { \u0026ldquo;ShortPost\u0026rdquo; : Post text for BlueSky and Mastodon, \u0026ldquo;LinkedInHeading\u0026rdquo; : Headline for LinkedIn Post, \u0026ldquo;LinkedInPost\u0026rdquo; : Post text for LinkedIn }\nCreate the Flow in Power Automate This is the Flow I created for writing post on social media. I will explain the steps in the following sections.\n\u0026ldquo;Manually trigger a flow\u0026rdquo; (this is the trigger) Of course you could also use another trigger like schedule post from a calendar . \u0026ldquo;Get Item\u0026rdquo; from SharePoint Online. This step gets the URL of the newest blog post from my SharePoint Blog list. \u0026ldquo;AIBuilder Predict Custom Prompt\u0026rdquo; from Common Data Service for Apps. This step uses the AI Prompt we created in the previous section to create the post text for the social media networks. \u0026ldquo;Start and Wait for a Text Suggestion Approval\u0026rdquo; from Approvals. This step waits for the approval of the post text. I use this step to check the post text before it is posted on social media. If you don\u0026rsquo;t want to check the post text before it is posted on social media you can skip this step and go directly to the next step. \u0026ldquo;Parse JSON\u0026rdquo;. This step parses the JSON from the previous step and creates the variables for the post text. Copy the JSON from the AI Builder step and paste it into the \u0026ldquo;Schema\u0026rdquo; field. \u0026ldquo;Condition\u0026rdquo;. This step checks if we approved the AI generated post text or not. If we approved the post text it will go to the next step. If we didn\u0026rsquo;t approve the post text it will go to the \u0026ldquo;Condition - No\u0026rdquo; step which will lead to the end of the Flow. \u0026ldquo;Apply to each\u0026rdquo;. This step will create a post for each social media network that we put in the Column in the SharPoint list. With the \u0026ldquo;switch\u0026rdquo; step we are running the \u0026ldquo;Run a Child Flow\u0026rdquo; step to create the post for each needed social media network. As you can see this is a very simple Flow. But it will save you a lot of time and you can be sure that your post text is correct. Now let\u0026rsquo;s see how you will use this Flow to create your social media posts. Please leave a comment if you have any questions or suggestions. Also please share your use cases for this Flow. ","date":"2024-01-28T09:57:41.109Z","image":"https://www.menzel.it/post/2024/01/social-media-content-creator-ai-prompts/Header-Picture_hufee8f29b6edf1bf13cecb5bf4b74c988_255909_120x120_fill_q75_box_smart1.jpeg","permalink":"https://www.menzel.it/post/2024/01/social-media-content-creator-ai-prompts/","title":"Social media content creator with AI Promts"},{"content":"Introduction Managing group ownership is crucial for maintaining order and security within an organization in Microsoft 365. A \u0026ldquo;No Owner Policy\u0026rdquo; in Microsoft 365 Groups prompts members to assume ownership when the original owner leaves, ensuring continuity and accountability. This blog post explores setting up this policy, its importance, and the different settings options.\nThe Importance of a No Owner Policy Ensuring Group Continuity When a group\u0026rsquo;s owner leaves, it can disrupt the group\u0026rsquo;s direction and leadership. The No Owner Policy addresses this by asking members to take ownership, ensuring the group remains active and well-managed.\nFacilitating Other Policies This policy is instrumental in supporting other group management policies. For example, the Inactive Group Policy or Guest Access Review Policy require an active owner for key decisions. Without this, such policies will not work correctly, leading to unmanaged groups or security risks.\nHow-to Set Up a No Owner Policy Access Microsoft 365 Admin Center Login: Sign in to the Microsoft 365 Admin Center using an administrator account. Navigate to Groups Find Groups Section: In the Admin Center, locate the \u0026lsquo;Settings\u0026rsquo; section. This is typically found in the navigation pane. Implementing the Policy Locate Group Policies: Within the Settings section, go to \u0026lsquo;Microsoft 365 Groups\u0026rsquo;. Enabling No Owner Policy: Look for an option that triggers a notification for group members to volunteer for ownership when the current owner leaves. Enable this setting. Configuring Notifications You can configure the following settings by clicking on the \u0026lsquo;Configure\u0026rsquo; link:\nSpecify who can receive ownership notifications: Choose whether all members or only selected members can receive notifications. Number of active members to notify: Set the number of members to notify. Only up to 90 active members, who aren\u0026rsquo;t guests, can be notified per group.\nNotify most active members: Set for how long these notifications are sent. Consider the urgency and how best to prompt a response without causing notification fatigue.\nSelect a sender: Choose who the notification is sent from. This can be the group email or a specific user.\nCustomize Notification Messages: Edit the default message to clearly explain why the member is receiving this notification and the importance of taking ownership. Select which groups to target: Choose which groups to target with this policy. You can select all groups or specific groups. Save and Test Review and finish: Review the settings and click \u0026lsquo;Save\u0026rsquo; to implement the policy. Test the Policy: It\u0026rsquo;s a good practice to test the policy with a few groups to ensure it works as expected and members receive notifications. Conclusion Setting up a No Owner Policy in Microsoft 365 Groups is a proactive step towards ensuring seamless group management and security. By following this how-to, organizations can effectively implement this policy to maintain continuous and responsible group management.\nIf you have any questions or feedback, please leave a comment below or reach out to me on social media.\n","date":"2023-12-19T10:00:38.286Z","image":"https://www.menzel.it/post/2023/12/set-owner-policy-microsoft-365-groups-important/image-2_hu1e55a1126ee4c67bc480facf05cd67b0_1527572_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/12/set-owner-policy-microsoft-365-groups-important/","title":"M365 Groups: Set Up a 'No Owner Policy' \u0026 why it's Important"},{"content":"Introduction Do you want to save time and effort by automating your social media posts across different platforms? Do you want to learn how to use Microsoft Power Automate to post on BlueSky and Mastodon with ease? If so, this guide is for you.\nIntegrating Mastodon with Hugo Blog for Comment Management To streamline the management of comments on my Hugo blog, I have implemented a Mastodon workflow. This workflow allows for easy retrieval of Mastodon post IDs. I use Mastadon as my comments platform as described in Carl Schwan\u0026rsquo;s blog post.\nCreating the Flows: I will provide you a detailed breakdown suitable for a custom implementation. This guide will ensure even those not deeply familiar with technical details can follow along.\nDetailed guide for creating a Custom BlueSky Posting Workflow in Microsoft Power Automate Introduction This section focuses on setting up a custom workflow in Microsoft Power Automate for posting updates to BlueSky, a social media platform. The workflow involves creating a session, posting content, and handling responses. At the time of writing, BlueSky is still invite-only, so you\u0026rsquo;ll need to request access to the platform before you can use this workflow. If you need access plesae contact me via Twitter, LinkedIn or in the comments down below.\nPrerequisites Access to Microsoft Power Automate. BlueSky account credentials and API access. Tips: Ensure you correctly handle the authentication and authorization part, particularly the management of JWT tokens. Test each part separately to ensure they work as expected. Be mindful of the data structure expected by BlueSky\u0026rsquo;s API when creating posts. This should give you a good starting point for rebuilding the BlueSky posting workflow in Power Automate. Adjust the steps according to your specific requirements and the exact response structure of the BlueSky API.\nCreate a New Flow in Power Automate Log in to Microsoft Power Automate. Navigate to My flows. Click on New flow and select Instant cloud flow. Name your flow, e.g., \u0026ldquo;Send to BlueSky\u0026rdquo;, and select the Manually trigger a flow trigger. Click Create. Steps and Expressions (BlueSky)): Trigger: Manual trigger with text, link, and heading inputs. Initialize Variable - Complete Text: Merge the ShortText and link inputs into a single string. - Expression: @{triggerBody()?['text']} @{triggerBody()?['text_1']}\nInitialize Variable - Remove Line Breaks: - Expression: @{UriComponentToString(replace(uriComponent(triggerBody()?['text']) '%0A' ''))}\nInitialize Variable - Facets: As an array variable.\nCompose - Get Single Words: Expression: @split(variables('Text'),' ') Apply to Each: Based on \u0026lsquo;Compose - Get Single Words\u0026rsquo; output. Condition: Checks for hashtag (#) in each item.\nExpression: startsWith(@items('Apply_to_each'),'#') Append to Array Variable - Hashtags:\nExpression for tag: { \u0026quot;index\u0026quot;: { \u0026quot;byteStart\u0026quot;: @{indexOf(triggerBody()['text'], item())}, \u0026quot;byteEnd\u0026quot;: @{add(indexOf(triggerBody()['text'],item()),length(item()))} }, \u0026quot;features\u0026quot;: [ { \u0026quot;$type\u0026quot;: \u0026quot;app.bsky.richtext.facet#tag\u0026quot;, \u0026quot;tag\u0026quot;: @{item()} } ] } Append to Array Variable - Mentions:\nExpression for Links: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 { \u0026#34;index\u0026#34;: { \u0026#34;byteStart\u0026#34;: @{indexOf(variables(\u0026#39;Complete Text\u0026#39;), item())}, \u0026#34;byteEnd\u0026#34;: @{add(indexOf(variables(\u0026#39;Complete Text\u0026#39;),item()),length(item()))} }, \u0026#34;features\u0026#34;: [ { \u0026#34;$type\u0026#34;: \u0026#34;app.bsky.richtext.facet#mention\u0026#34;, \u0026#34;handle\u0026#34;: \u0026#34;@{item()}\u0026#34; } ] } { \u0026#34;index\u0026#34;: { \u0026#34;byteStart\u0026#34;: @{indexOf(variables(\u0026#39;Complete Text\u0026#39;), triggerBody()[\u0026#39;text_1\u0026#39;])}, \u0026#34;byteEnd\u0026#34;: @{add(indexOf(variables(\u0026#39;Complete Text\u0026#39;),triggerBody()[\u0026#39;text_1\u0026#39;]),length(triggerBody()[\u0026#39;text_1\u0026#39;]))} }, \u0026#34;features\u0026#34;: [ { \u0026#34;$type\u0026#34;: \u0026#34;app.bsky.richtext.facet#link\u0026#34;, \u0026#34;uri\u0026#34;: \u0026#34;@{triggerBody()[\u0026#39;text_1\u0026#39;]}\u0026#34; } ] } Explanation: The expression uses the Complete Text variable to find the position of the link in the text using the indexOf function. It then creates the link facet using the link input from the trigger. For more information on the BlueSky API, refer to the documentation. HTTP - Create Session: URI: https://bsky.social/xrpc/com.atproto.server.createSession Body: { \u0026quot;identifier\u0026quot;: \u0026quot;@{parameters('BlueSky HandleName')}\u0026quot;, \u0026quot;password\u0026quot;: \u0026quot;@{parameters('BlueSky App Password')}\u0026quot; } Parse JSON - New Session Response:\nTipp: Use the Generate from sample option to generate the schema. To get the sample, you can use the Run Flow option and copy the response from the Run History. HTTP - Post Post: URI: https://bsky.social/xrpc/com.atproto.repo.createRecord Body: { \u0026quot;repo\u0026quot;: \u0026quot;menzel.it\u0026quot;, \u0026quot;collection\u0026quot;: \u0026quot;app.bsky.feed.post\u0026quot;, \u0026quot;record\u0026quot;: { \u0026quot;createdAt\u0026quot;: \u0026quot;@utcNow()\u0026quot;, \u0026quot;facets\u0026quot;: \u0026quot;@if(equals(length(variables('facets')),0),'[]',variables('facets'))\u0026quot;, \u0026quot;text\u0026quot;: \u0026quot;@variables('Complete Text')\u0026quot; } } Authentication: Requires an API key from BlueSky Social\u0026rsquo;s account settings​​. Send2Mastodon Here\u0026rsquo;s the step-by-step tutorial:\nPrerequisites Access to Microsoft Power Automate. Microsoft Teams set up. Mastodon account and API key. Create a New Flow in Power Automate Log in to Microsoft Power Automate. Navigate to My flows. Click on New flow and select Instant cloud flow. Name your flow, e.g., \u0026ldquo;Send to Mastodon\u0026rdquo;, and select the Manually trigger a flow trigger. Click Create. Steps and Expressions To recreate the workflow in Power Automate based on the provided JSON file, follow these steps:\nTrigger: Manual trigger with text, link, and heading inputs. HTTP Request to Mastodon API: Add an HTTP action to post a status update to Mastodon. Set the method to POST. Set the URI to https://[Mastodon Server Link]/api/v1/statuses replace [Mastodon Server Link] with the actual server link.\nI used environment variables for this as I store everything in a solution. Add headers: Authorization: Bearer [Mastodon-Key] (replace [Mastodon-Key] with the actual key). Content-Type: application/x-www-form-urlencoded. Set the body to send the status and link: \u0026quot;status=@{triggerBody()?['text']}\\n@{triggerBody()?['text_1']}\u0026quot;. Parse JSON: After the HTTP request, add a \u0026ldquo;Parse JSON\u0026rdquo; action. Use @body('HTTP') as the content. Define the schema based on the expected response from the Mastodon API. Tipp: Use the Generate from sample option to generate the schema. To get the sample, you can use the Run Flow option and copy the response from the Run History. Post Message in Teams Channel: Add an action to post a message in a Teams chat or channel. Configure the message to include the Mastodon toot ID and the heading from the trigger inputs. Use the expression @{triggerBody()?['text_2']} for the heading and @{body('Parse_JSON')?['id']} for the Mastodon toot ID. Final Steps:\nSave and test the flow to ensure it works as expected. Make any necessary adjustments to the expressions and configurations based on your specific requirements and the structure of your Mastodon instance and Teams setup. Conclusion This guide provides an overview of using Microsoft Power Automate to automate social media posts across various platforms, like BlueSky, Mastodon and LinkedIn. I hope you found this guide useful and that it helps you to get started with Power Automate. If you have any questions or feedback, please leave a comment below. Also you can combine this with a SharePoint list to create a queue for your posts. If this is interessting for you I will cover this in a future post. I added the Flows to my GitHub repo so you can download them and import them into your environment.\nReferences BlueSky API Documentation Mastodon API Documentation Flows for download on GitHub ","date":"2023-11-26T21:25:48.951Z","image":"https://www.menzel.it/post/2023/11/power-automate-posting-bluesky-mastodon/Blog-Header_hu5a1df5d6cca77f0876c4c8749db3d7d6_134628_120x120_fill_q75_box_smart1.jpeg","permalink":"https://www.menzel.it/post/2023/11/power-automate-posting-bluesky-mastodon/","title":"Power Automate - How-to Posting on BlueSky and Mastodon"},{"content":"Understanding External User Access\nBefore diving into the reviews, it\u0026rsquo;s important to understand what external access entails. External users in O365 are individuals who are not employees, or onsite agents for your organization. They could be partners, vendors, or consultants who need access to certain parts of your O365 environment, such as SharePoint sites or Microsoft Teams.\nThe Need for Access Reviews\nThe principle of least privilege mandates that users should have access only to the information and resources that are absolutely necessary for their work. Over time, access requirements can change, and periodic reviews ensure that external users only have the access they need. This is where O365\u0026rsquo;s access review feature comes into play, allowing for the systematic verification and auditing of user privileges.\nSetting Up Access Reviews\nTo set up access reviews in O365, follow these steps:\nNavigate to the Access Reviews Dashboard: Access this via the Microsoft 365 compliance center or Azure Active Directory (EntraID) portal. Create a New Access Review: Specify the scope of the review, whether it\u0026rsquo;s targeted at guest users across all Microsoft Teams and Groups or specific ones. Define Review Settings: Choose who will perform the review (group owners, specific users, or application owners), set the frequency (one-time or recurring), and establish the start and end dates. Customize Review Settings: Decide on the outcomes for denied access, such as automatic removal or a manual step, and whether reviewers receive reminders. Review and Confirm: Double-check the settings, and then create the access review. Conducting the Review\nOnce set up, designated reviewers will be notified to examine the access rights of external users. Reviewers can approve or deny access for each user, and they can provide reasons for their decisions. It\u0026rsquo;s best practice to include guidelines for making these decisions to ensure consistency and compliance.\nExamples of Access Reviews in Action\nVendor Access Review: A company conducts quarterly reviews of vendor access to its internal procurement system to validate that only current vendors have access.\nConsultant Project Completion: Upon the completion of a project, the external consultant’s access to the project’s SharePoint site is reviewed and revoked if no longer needed.\nPartner Collaboration: Annual reviews of a partner organization’s access to shared Teams channels are performed to ensure that only relevant individuals retain access.\nBest Practices\nRegular Schedule: Conduct access reviews on a regular schedule to maintain security hygiene.\nClear Documentation: Keep detailed records of each review for auditing purposes.\nUser Notification: Inform external users about the review process to ensure transparency and avoid confusion if access is altered or revoked.\nConclusion\nAccess reviews in O365 are an essential practice for maintaining secure and efficient collaborations with external users. By regularly reviewing and adjusting access rights, organizations can protect sensitive information while facilitating productive partnerships. With O365’s robust access review tools, you can ensure that your external collaborations are both productive and secure.\n","date":"2023-11-12T20:19:16.212Z","image":"https://www.menzel.it/post/2023/11/external-user-access-reviews-office-365-ensuring-secure-collaboration/HeaderImage_hu0a623bf29a7672a240b15a0ca32d70e1_1618143_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/11/external-user-access-reviews-office-365-ensuring-secure-collaboration/","title":"External User Access Reviews in Office 365"},{"content":"Adding and Editing Images with the Image Web Part The Image web part simplifies the process of adding visual elements to your SharePoint Online pages. Here\u0026rsquo;s how you can set it up:\nInserting an Image Navigate to the page where you want to add an image and select \u0026ldquo;Edit\u0026rdquo; at the top right of the page to enable editing mode. Choose the section you want to insert the Image web part and click the \u0026ldquo;+\u0026rdquo; sign to add a new web part. Select \u0026ldquo;Image\u0026rdquo; from the list of available web parts. Editing an Image Once the image is inserted, you might want to fine-tune its appearance. Click the \u0026lsquo;Advanced editing\u0026rsquo; to access the editing options. From there, you can: Crop: Adjust the framing of your image to focus on the most important elements. Adjustment: Modify brightness, contrast, and saturation to ensure your image stands out or blends in with the overall design. Filters: Apply filters for artistic effects or to conform to your branding guidelines. Markup: Add shapes, lines, and text to your image to highlight specific elements. Adding Text Overlays Enhance your images by adding text directly over them. While in the edit mode of the Image web part, you\u0026rsquo;ll find an option to \u0026ldquo;add text over the image.\u0026rdquo; Click on it, and a text box will appear on your image where you can enter your desired text. This feature is particularly useful for headers, announcements, or to convey additional context. Configuring Accessibility It\u0026rsquo;s crucial to ensure that your images are accessible to all users. When editing the Image web part, add descriptive alternative text that accurately represents the image content for users who use screen readers.\nSaving Your Edits After making all your edits, don\u0026rsquo;t forget to save your changes. You can publish or republish the page to make the changes live or you can \u0026lsquo;Save as draft\u0026rsquo; to work on this page later.\nConclusion The Image web part in SharePoint Online is a powerful tool that, with its new editing capabilities, can significantly enhance the visual impact of your pages. By following these detailed steps, you can effectively use images to complement your textual content, make your pages more engaging, and ensure they are inclusive for all users.\n","date":"2023-11-09T13:19:06+01:00","image":"https://www.menzel.it/post/2023/11/spimageediting/HeaderImage_huefa2d296b3d689e8c666e69baf0e4849_779101_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/11/spimageediting/","title":"New Image Editing Options in SharePoint Online: A Deep Dive into the Image Web Part"},{"content":"Why Bother with Metadata? Think of metadata as the DNA of your SharePoint content. It tells you who created a document, when it was last touched, and more. This information isn’t just for kicks; it\u0026rsquo;s vital for audits, compliance, and knowing the lineage of your content.\nKeeping Metadata Intact with Updates Sometimes you need to adjust a document\u0026rsquo;s details but want to keep the original \u0026lsquo;Modified By\u0026rsquo; data. PnP PowerShell is your ally here:\n1 2 3 4 5 6 7 # Connect to your SharePoint site Connect-PnPOnline -Url https://contoso.sharepoint.com/sites/demo -Interactive # Preserve metadata with a SystemUpdate Set-PnPListItem -List \u0026#34;Tasks\u0026#34; -Identity $item -Values @{ \u0026#34;Title\u0026#34;=\u0026#34;New Project Title\u0026#34; } -UpdateType SystemUpdate Understanding Update Types in PnP PowerShell When you\u0026rsquo;re updating SharePoint items with PnP PowerShell, you have three update methods at your disposal, each serving a different purpose. Let\u0026rsquo;s demystify these:\nUpdate\nThis is the standard update command. When you use Update, SharePoint treats the action as if you manually updated the item through the UI. This means:\nThe \u0026ldquo;Modified\u0026rdquo; and \u0026ldquo;Modified By\u0026rdquo; fields will be updated to reflect the time of the update and the user who made the change. If versioning is enabled on the list or library, a new version will be created. Use it when you want to make a straightforward update that logs your changes as a new version.\nSystemUpdate\nSystemUpdate is more discreet:\nIt updates items without changing the \u0026ldquo;Modified By\u0026rdquo; and \u0026ldquo;Modified\u0026rdquo; fields. A new version is created if versioning is enabled, but it will not show as a new \u0026ldquo;modified\u0026rdquo; entry. This method is perfect when you need to make changes that don\u0026rsquo;t affect the item\u0026rsquo;s version history as seen by end-users, like during system migrations or bulk updates.\nUpdateOverwriteVersion\nThe UpdateOverwriteVersion is the stealth operator:\nIt updates the item while keeping the \u0026ldquo;Modified By\u0026rdquo; and \u0026ldquo;Modified\u0026rdquo; fields as they were. It does not create a new version; instead, it overwrites the current version, even if versioning is enabled. This approach is suitable when you want to make a correction to the current version of an item or document without increasing the version count, effectively keeping the update under the radar.\nChanging Creator and Creation Dates: Is It Even Possible? Yes, it is! Adjusting the creator or creation date of a document is sometimes necessary, such as during migrations or clean-ups. Here\u0026rsquo;s how you can accomplish this:\n1 2 3 4 5 6 7 8 9 # Fetch the item you need to update $item = Get-PnPListItem -List \u0026#34;Documents\u0026#34; -Id 42 # Change the \u0026#34;Created By\u0026#34; and \u0026#34;Created\u0026#34; fields $creationDate = Get-Date \u0026#34;2020-01-14\u0026#34; Set-PnPListItem -List \u0026#34;Documents\u0026#34; -Identity $item -Values @{ \u0026#34;Author\u0026#34; = $newCreatorUserId; \u0026#34;Created\u0026#34; = $creationDate } -SystemUpdate Data Integrity Best Practices To safeguard your SharePoint content during updates, here are some best practices to uphold data integrity:\nMaintain a Change Log: Documenting changes ensures accountability and traceability. Secure Approvals: Validate that all updates are authorized and documented. Test Before Implementing: Always preview changes in a safe environment to prevent unintended consequences in your live content. Conclusion With PnP PowerShell, you have the tools to adjust metadata with precision, ensuring that your SharePoint data tells its true story without unintended revisions. It\u0026rsquo;s about strategic changes that respect the narrative of your data.\nFurther Reading Delve deeper into PnP PowerShell with the official cmdlet documentation for Set-PnPListItem, available here.\n","date":"2023-11-06T15:58:22+01:00","image":"https://www.menzel.it/post/2023/11/update-sharepoint-metadata-pnp-powershell/SP-Metadata_hu8a0927647fb612d41352e2a9e1819f48_1340266_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/11/update-sharepoint-metadata-pnp-powershell/","title":"Silently Update SharePoint Metadata with PnP PowerShell: A Guide for Admins"},{"content":"Introduction In SharePoint Online, users can store their files in OneDrive for Business, which is a personal document library that is associated with their user account. Sometimes, users may accidentally delete their OneDrive site or get deleted when they leave the company, which can result in the loss of important files and data.\nFortunately, SharePoint Online administrators can restore deleted OneDrive sites using PowerShell and the PnP PowerShell module. In this blog post, we will discuss how to use the PowerShell script \u0026ldquo;Get-deleted-OneDrives.ps1\u0026rdquo; to restore a deleted OneDrive site.\nPrerequisites Before we begin, you will need to have the following:\nA SharePoint Online tenant administrator account PowerShell 7.2 or later installed on your computer The PnP PowerShell module installed on your computer Script Overview The \u0026ldquo;Get-deleted-OneDrives.ps1\u0026rdquo; script is a PowerShell script that uses the PnP PowerShell module to restore a deleted OneDrive site. Here\u0026rsquo;s an overview of what the script does:\nConnects to SharePoint Online using the Connect-PnPOnline cmdlet. Retrieves a list of all deleted OneDrive sites using the Get-PnPTenantDeletedSite cmdlet. Filters the list of deleted OneDrive sites to find the site that matches the specified user name using the Where-Object cmdlet. Restores the deleted OneDrive site using the Restore-PnPTenantSite cmdlet. Checks if the site was successfully restored using the Get-PnPTenantSite cmdlet. Disconnects from SharePoint Online using the Disconnect-PnPOnline cmdlet. Let\u0026rsquo;s take a closer look at each step of the script.\nStep 1: Connect to SharePoint Online The first step of the script is to connect to SharePoint Online using the Connect-PnPOnline cmdlet. This cmdlet requires the URL of your SharePoint Online site and your credentials.\nIn the script, the URL of the SharePoint Online admin center is used as the site URL. The -interactive parameter is used to prompt the user for their credentials.\n1 Connect-PnPOnline -Url \u0026#34;https://yourtenant-admin.sharepoint.com\u0026#34; -interactive Step 2: Retrieve a List of Deleted OneDrive Sites The second step of the script is to retrieve a list of all deleted OneDrive sites using the Get-PnPTenantDeletedSite cmdlet. This cmdlet retrieves a list of all deleted sites in the SharePoint Online tenant, including OneDrive sites.\nIn the script, the -IncludeOnlyPersonalSite parameter is used to retrieve only deleted OneDrive sites.\n1 $DeletedOneDrives = Get-PnPTenantDeletedSite -IncludeOnlyPersonalSite Step 3: Filter the List of Deleted OneDrive Sites The third step of the script is to filter the list of deleted OneDrive sites to find the site that matches the specified user name using the Where-Object cmdlet.\nIn the script, the Where-Object cmdlet is used to filter the $DeletedOneDrives array to find the OneDrive site that contains the specified user name in its URL. The -like operator is used to perform a case-insensitive match on the Url property of each object in the array.\n1 $FoundOneDrive = $DeletedOneDrives | Where-Object { $_.Url -like \u0026#39;*oliver_menzel*\u0026#39; } Step 4: Restore the Deleted OneDrive Site The fourth step of the script is to restore the deleted OneDrive site using the Restore-PnPTenantSite cmdlet. This cmdlet requires the URL of the deleted site and the -Force parameter to confirm the restoration.\nIn the script, the URL of the OneDrive site that was found in step 3 is used as the URL parameter for the Restore-PnPTenantSite cmdlet.\n1 Restore-PnPTenantSite -Url $FoundOneDrive.Url -Force Step 5: Check if the Site was Restored The fifth step of the script is to check if the OneDrive site was successfully restored using the Get-PnPTenantSite cmdlet. This cmdlet requires the URL of the site that was restored.\nIn the script, the URL of the OneDrive site that was found in step 3 is used as the URL parameter for the Get-PnPTenantSite cmdlet.\n1 Get-PnPTenantSite -Url $FoundOneDrive.Url Step 6: Disconnect from SharePoint Online The final step of the script is to disconnect from SharePoint Online using the Disconnect-PnPOnline cmdlet.\n1 Disconnect-PnPOnline The whole script looks like this: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # Connect to SharePoint Online using PnP PowerShell Connect-PnPOnline -Url \u0026#34;https://yourtenant-admin.sharepoint.com\u0026#34; -interactive # Get-PnPDeletedSite $DeletedOneDrives = Get-PnPTenantDeletedSite -IncludeOnlyPersonalSite #Find deleted OneDrive by user name in url $FoundOneDrive = $DeletedOneDrives | Where-Object { $_.Url -like \u0026#39;*oliver_menzel*\u0026#39; } #Restore deleted OneDrive Restore-PnPTenantSite -Url $FoundOneDrive.Url -Force #Check if Site was restored Get-PnPTenantSite -Url $FoundOneDrive.Url Disconnect-PnPOnline Conclusion In this blog post, we discussed how to use a PowerShell script to restore a deleted OneDrive site in SharePoint Online. We covered the prerequisites for running the script, the overview of the script, and the details of each step of the script.\nBy using this script, SharePoint Online administrators can quickly and easily restore deleted OneDrive sites and prevent the loss of important files and data.\n","date":"2023-10-27T15:22:18+02:00","image":"https://www.menzel.it/post/2023/10/deleted_onedrive/header_hu9a40e9a801e330a7ff36615729e71f63_1128335_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/10/deleted_onedrive/","title":"Find / Restore Deleted OneDrive Sites with PnP PowerShell"},{"content":"Introduction Microsoft Clarity is a free web analytics tool that helps website owners understand how users interact with their website. Clarity provides insights into user behavior, such as heatmaps, session recordings, and funnels, which can be used to optimize the user experience and improve website performance.\nWhy Use Clarity for a SharePoint Portal? Microsoft Clarity can be a useful tool for gaining insights into how users interact with your SharePoint portal. By using Clarity, you can:\nIdentify areas of your portal that are causing confusion or frustration for users. Optimize the user experience by making changes based on user behavior. Improve website performance by identifying and fixing issues that are causing users to leave your portal. Clarity provides a range of features that can help you gain insights into user behavior, including heatmaps, session recordings, and funnels. By using these features, you can gain a deeper understanding of how users interact with your SharePoint portal and make data-driven decisions to improve the user experience.\nPrerequisites Before we get started, there are a few prerequisites that you will need:\nA SharePoint Online site where you have permission to add custom actions. PowerShell 7.2 or later installed on your computer. The PnP PowerShell module installed on your computer. A Microsoft Clarity account. You can sign up for a free account at https://clarity.microsoft.com/. Get the Product ID of the Clarity App. You will need it in the script. Installing the SharePoint App As a SharePoint Administrator, you can acquire apps from this repository: https://handsontek.net/Downloads/clarity.zip if you want more information about the app, you can also find an other version here: https://github.com/joaoferreira/microsoftclarity/\nLog in to the SharePoint Admin Center In the SharePoint Admin Center click on more features and then click on the Apps button. Upload App to the SharePoint Click the upload button and choose the dowloaded app file. Define the scope of the App Select if you want to install the App for the whole tenant or only for specific sites. Check Apps for SharePoint Check the Apps for SharePoint list to see if the app was added successfully. Add Clarity App to SiteCollection\nGo to the SiteCollection where you want to add the Clarity App and click on the cogwheel in the top right corner. Then click on Add an app. In the My apps page click on the All tab and then click on the Clarity app. The Script The PowerShell script below demonstrates how to activate Microsoft Clarity on a SharePoint SiteCollection:\n1 2 3 4 5 6 7 8 # Connect to SharePoint Online using PnP PowerShell Connect-PnPOnline -Url \u0026#34;https://yourtenant.sharepoint.com/sites/yoursite\u0026#34; -Interactive # Add custom action for Microsoft Clarity Add-PnPCustomAction -ClientSideComponentId \u0026#39;7f8fd1f2-9d26-4a4a-a607-bf4622d7ec11\u0026#39; -Name \u0026#34;Microsoft Clarity\u0026#34; -Title \u0026#34;Microsoft Clarity\u0026#34; -Location ClientSideExtension.ApplicationCustomizer -ClientSideComponentProperties: \u0026#39;{\u0026#34;clarityID\u0026#34;:\u0026#34;Add your Clarity ID here\u0026#34;}\u0026#39; -Scope site # Check if custom action was installed successfully $CA = Get-PnPCustomAction -scope site The script first connects to the SharePoint site using PnP-PowerShell and then adds a custom action for Microsoft Clarity using the Add-PnPCustomAction cmdlet. The custom action is added to the site scope and specifies the client-side component ID, name, title, location, and client-side component properties.\nFinally, the script checks if the custom action was installed successfully using the Get-PnPCustomAction cmdlet.\nOnce you\u0026rsquo;ve set up Clarity on your SharePoint site, it typically takes one to two hours for the dashboard to be configured and start receiving user analytics data. After that, simply refresh the dashboard to view all the metrics and insights.\nConclusion In this blog post, we explored how to use PowerShell to set up Microsoft Clarity for a SharePoint portal. By using Clarity, you can gain insights into how users interact with your portal and optimize the user experience.\nBy using PowerShell and the PnP PowerShell module, you can automate this process and save time and effort when setting up Clarity for your SharePoint portal.\n","date":"2023-10-23T20:35:23+02:00","image":"https://www.menzel.it/post/2023/10/addclarity/HeaderImage_hu9a40e9a801e330a7ff36615729e71f63_1490024_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/10/addclarity/","title":"How to set up Microsoft Clarity for SharePoint SiteCollections with PowerShell"},{"content":"PnP PowerShell is a powerful tool that allows you to interact with SharePoint and perform various operations, including restoring files from the recycle bin. In this blog post, we will explore how to use PnP PowerShell to restore files from the recycle bin, filter by path or folder, and filter by timespan.\nBasic Commands Here are some of the basic cmdlets you can use:\nGet-PNPRecycleBinItem: This cmdlet retrieves all items in the recycle bin. Restore-PnPRecycleBinItem: This cmdlet restores the specified item from the recycle bin to its original location. Here is an example of how you can use these cmdlets:\n1 2 3 4 5 # Get a specific recycle bin item $item = Get-PNPRecycleBinItem -Identity \u0026lt;ID\u0026gt; # Restore the item Restore-PnPRecycleBinItem -Identity $item -Force In this example, replace \u0026lt;ID\u0026gt; with the ID of the recycle bin item you want to restore.\nFiltering by Path or Folder You can filter the items in the recycle bin based on their directory name or title. Here is an example:\n1 2 3 4 5 6 7 8 9 Get-PnPRecycleBinItem | ForEach-Object { $dir = $_.DirName $title = $_.Title $path = \u0026#34;$dir/$title\u0026#34; $fileExists = Get-PnPFile -url $path -ErrorAction SilentlyContinue if (!$fileExists) { $_ | Restore-PnpRecycleBinItem -Force -ErrorAction SilentlyContinue } } In this example, Get-PnPRecycleBinItem retrieves all items in the recycle bin. The ForEach-Object cmdlet iterates over each item. If a file with the same path does not already exist, the script restores the item.\nFiltering by Timespan You can also filter items based on their deletion date. Here is an example:\n1 2 $restoreDate = (Get-Date).AddDays(-30) Get-PnPRecycleBinItem | Where-Object { $_.DeletedDate -gt $restoreDate } | Restore-PnpRecycleBinItem -Force In this example, Get-Date gets the current date and time, and AddDays(-30) subtracts 30 days from it. The Where-Object cmdlet filters out items that were deleted more than 30 days ago. The script then restores the remaining items.\nRestoring Files Deleted in Last 3 Hours from a Specific Folder Here\u0026rsquo;s an example of how you can restore files that were deleted in the last 3 hours and were located in a certain folder:\n1 2 3 $restoreDate = (Get-Date).AddHours(-3) $folderPath = \u0026#34;\u0026lt;YourFolderPath\u0026gt;\u0026#34; Get-PnPRecycleBinItem | Where-Object { $_.DeletedDate -gt $restoreDate -and $_.DirName -eq $folderPath } | Restore-PnpRecycleBinItem -Force In this example, replace \u0026lt;YourFolderPath\u0026gt; with your specific folder path. with something like this: $folderPath = \u0026quot;/sites/YourSiteName/Shared Documents/YourFolderName\u0026quot;\nPlease note that you need to be connected to your SharePoint site using Connect-PnPOnline before running these commands.\nConclusion PnP PowerShell provides a powerful way to manage your SharePoint site, including restoring files from the recycle bin. By understanding how to use these cmdlets and how to filter by path or folder and timespan, you can effectively manage your SharePoint site\u0026rsquo;s content.\nRemember to always test your scripts in a safe environment before running them on your live site to avoid any unintended consequences.\nHappy coding! 🚀\nReferences: PnP PowerShell Overview SharePoint Online: How to Restore Items from Recycle Bin using PowerShell? Restore-PnPRecycleBinItem Connect-PnPOnline How to restore items from Recycle Bin in SharePoint Online using PnP PowerShell ","date":"2023-10-15T22:52:41+02:00","image":"https://www.menzel.it/post/2023/10/restorerecyclebin/RecycleBin_hu5a1df5d6cca77f0876c4c8749db3d7d6_164575_120x120_fill_q75_box_smart1.jpeg","permalink":"https://www.menzel.it/post/2023/10/restorerecyclebin/","title":"Restoring Files from the Recycle Bin in SharePoint using PnP PowerShell"},{"content":"Prerequisites Before we get started, there are a few prerequisites that you will need:\nA SharePoint Online site where you have permission to create and edit news pages. PowerShell 7.2 or later installed on your computer. The PnP.PowerShell module installed on your computer. The Script The PowerShell script below demonstrates how to change the first publish date of a news page in SharePoint Online:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # Set the new publish date $publishDate = \u0026#39;2023-10-12\u0026#39; # Set the ID of the news item to update $newsItemId = 361 # Connect to the SharePoint site using PnP-PowerShell Connect-PnPOnline \u0026#34;https://yourtenant.sharepoint.com/sites/yoursite\u0026#34; -ClientId $AppID -Interactive # Get the news item in English $englishNewsItem = Get-PnPListItem -List \u0026#39;SitePages\u0026#39; -Id $newsItemId # Update the news item with the new publish date Set-PnPListItem -List \u0026#39;SitePages\u0026#39; -Identity $newsItemId -Values @{\u0026#39;FirstPublishedDate\u0026#39; = $publishDate } -UpdateType SystemUpdate # Check if the news item has any translations if ($englishNewsItem.FieldValues._SPTranslatedLanguages) { # If there are translations, get the UniqueId of the English news item $uniqueId = $englishNewsItem.FieldValues.UniqueId # Get the translated news items $translatedNewsItems = Get-PnPListItem -List \u0026#39;SitePages\u0026#39; -Query \u0026#34;\u0026lt;View Scope=\u0026#39;RecursiveAll\u0026#39;\u0026gt;\u0026lt;Query\u0026gt;\u0026lt;Where\u0026gt;\u0026lt;Contains\u0026gt;\u0026lt;FieldRef Name=\u0026#39;_SPTranslationSourceItemId\u0026#39;/\u0026gt;\u0026lt;Value Type=\u0026#39;Guid\u0026#39;\u0026gt;$($uniqueId)\u0026lt;/Value\u0026gt;\u0026lt;/Contains\u0026gt;\u0026lt;/Where\u0026gt;\u0026lt;/Query\u0026gt;\u0026lt;/View\u0026gt;\u0026#34; # Update each translated news item foreach ($translatedNewsItem in $translatedNewsItems) { Set-PnPListItem -List \u0026#39;SitePages\u0026#39; -Identity $translatedNewsItem.Id -Values @{\u0026#39;FirstPublishedDate\u0026#39; = $publishDate } -UpdateType SystemUpdate } } The script starts by setting the new publish date and the ID of the news item to update. You will need to modify these values to match your specific scenario.\nNext, the script connects to the SharePoint site using PnP-PowerShell and retrieves the news item in English. The script then updates the news item with the new publish date using the Set-PnPListItem cmdlet.\nThe script then checks if the news item has any translations. If there are translations, the script retrieves the UniqueId of the English news item and uses it to get the translated news items. The script then updates each translated news item with the new publish date using the Set-PnPListItem cmdlet.\nConclusion In this blog post, we explored how to use PowerShell to change the first publish date of a news page in SharePoint Online. This can be a useful tool for updating the publish date of a news page to reflect changes in the content or to correct errors in the original publish date.\nBy using PowerShell and the PnP PowerShell module, you can automate this process and save time and effort when managing your SharePoint Online news pages.\n","date":"2023-10-13T08:22:49+02:00","image":"https://www.menzel.it/post/2023/10/changepublishdate/ChangePublishDate_huf677ab5284dc3059c291ae31652dfe1d_265353_120x120_fill_q75_box_smart1.jpeg","permalink":"https://www.menzel.it/post/2023/10/changepublishdate/","title":"How to use PowerShell to change the publish date of a news page in SharePoint Online"},{"content":"If you are using SharePoint Online, you may have created a hub site to organize your related sites and provide a consistent look and feel. A hub site consists of a main hub site and several associated sites that are connected to the hub. Each site has its own security and permissions, which means that users who have access to the hub site may not have access to the associated sites, and vice versa.\nHowever, in some scenarios, you may want to sync the permissions of the hub site to the associated sites, so that users who have access to the hub site can also have access to the associated sites. For example, if you have a hub site for an Intranet and several associated sites for different teams, you may want everyone in the company to have at least read access to all the sites within the hub.\nFortunately, SharePoint Online has a feature called Hub Sync Permissions that allows you to do this easily. In this blog post, I will show you how to enable this feature and what it does.\nHow to Enable Hub Sync Permissions To enable Hub Sync Permissions, you need to do two steps:\nEnable the feature at the hub site level. Enable the feature at each associated site. Step 1: Enable the feature at the hub site level To enable the feature at the hub site level, you need to:\nNavigate to the main hub site. Click on Site permissions from the gear icon menu. Click on the Hub Tab. Turn on the toggle for Sync hub permissions to associated sites. Select a security group that will serve as the hub visitors. This group will be added to all the associated sites as visitors. You can use any existing security group or create a new one. Step 2: Enable the feature at each associated site To enable the feature at each associated site, you need to:\nNavigate to each associated site that you want to sync permissions with. Click on Site permissions from the gear icon menu. Click on the Hub Tab. Turn on the toggle for Sync hub permissions to this site. What Hub Sync Permissions Does When you enable Hub Sync Permissions, it does two things:\nIt adds the hub visitors group that you selected at the hub site level to each associated site as visitors. This means that users who are in this group will have read access to all the sites within the hub. It creates a new security group called Hub Visitors at each associated site. This group contains all the Visitors of the hub site. This means that users who are Visitors of the hub site will also be Visitors of all the associated sites. How to Disable Hub Sync Permissions If you want to disable Hub Sync Permissions, you can do so by:\nTurning off the toggle for Sync hub permissions to this site at each associated site level. Turning off the toggle for Sync hub permissions to associated sites at the hub site level. Note that disabling Hub Sync Permissions will not remove the existing permissions that were added by this feature. You will need to manually remove them if you want to.\nConclusion Hub Sync Permissions is a useful feature that allows you to sync the permissions of your hub site and your associated sites in SharePoint Online. It can help you simplify your permission management and ensure consistent access across your related sites. However, you should also be aware of its implications and limitations before using it.\nI hope this blog post was helpful for you. If you have any questions or feedback, please contact me at one of the social networks. Thank you for reading!\n","date":"2023-10-08T11:23:54+02:00","image":"https://www.menzel.it/post/2023/10/hub_sync_permissions/image-3_hu7d116d096ef4ed34ced1b52a4853405e_1121548_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/10/hub_sync_permissions/","title":"How to Sync Hub Permissions to Associated Sites in SharePoint Online"},{"content":"What is OpenAI and why use it in PowerApps? OpenAI is a research organization that aims to create artificial intelligence (AI). They have developed a general-purpose NLP system called GPT-3/ GPT-4, which can generate coherent and relevant text for a wide range of tasks, such as answering questions, writing summaries, creating content, and more.\nBy using OpenAI in PowerApps, you can leverage the power of GPT-3 to enhance your apps with natural language features, such as chatbots, text analysis, content generation, and more. You can also use OpenAI to create dynamic and engaging user experiences that are tailored to your specific needs and goals.\nHow to sign up for the OpenAI API? To sign up for the OpenAI API, follow these steps:\nSign up to the official OpenAI platform https://platform.openai.com/. Once you’re logged in, navigate to the Personal tab in the top-right section. Select the View API Keys option from the dropdown. On the API keys page, click on the Create new secret key button. Remember to store the key somewhere safe as you won’t be able to view it again. The ChatGPT API allows developers to integrate ChatGPT into their own applications. It’s important to note that the API has its own pricing, which you can find at OpenAI Pricing. The ChatGPT API is not included in the ChatGPT Plus subscription and is billed separately.\nHow to set up a custom connector for OpenAI? Once you have your API key, you can set up a custom connector for OpenAI in PowerApps. A custom connector is a way to connect your app to any web service that has a RESTful API. You can use custom connectors to access data and actions that are not available in the standard connectors.\nTo set up a custom connector for OpenAI, follow these steps:\nGo to https://make.powerapps.com/ and sign in with your Microsoft account.\nIn the left navigation pane, click on Custom connectors. Click on New custom connector \u0026gt; Create from blank. Enter a name for your connector, such as \u0026ldquo;ChatGPT\u0026rdquo;, and click Continue. In the General tab, enter the following information:\nDescription: A brief description of your connector, such as \u0026ldquo;A custom connector for OpenAI\u0026rdquo;. Host: The base URL of the OpenAI API, which is \u0026ldquo;api.openai.com\u0026rdquo;. Click on Security Authentication type: Select \u0026ldquo;API Key\u0026rdquo; from the drop-down menu. Parameter label: The name of the parameter that holds your API key, such as \u0026ldquo;API Key\u0026rdquo;. Parameter name: The name of the header that holds your API key, which is \u0026ldquo;Authorization\u0026rdquo;. Parameter location: Select \u0026ldquo;Header\u0026rdquo; from the drop-down menu. Click on Definition \u0026gt; New action and enter the following information: Summary: A brief summary of what the action does, such as \u0026ldquo;Generate text using OpenAI\u0026rdquo;. Description: A detailed description of what the action does, such as \u0026ldquo;Generates text using OpenAI\u0026rsquo;s GPT-3 engine based on a given prompt and parameters\u0026rdquo;. Operation ID: A unique identifier for the action, such as \u0026ldquo;GenerateText\u0026rdquo;. Click on Request \u0026gt; Import from sample and enter the following information: Verb: Select \u0026ldquo;POST\u0026rdquo; from the drop-down menu. URL: The endpoint of the OpenAI API that you want to use, which is \u0026ldquo;https://api.openai.com/v1/chat/completions\". Headers: Leave this blank. Body: A sample JSON body that contains the parameters for the text generation, such as: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 { \u0026#34;model\u0026#34;: \u0026#34;gpt-3.5-turbo\u0026#34;, \u0026#34;messages\u0026#34;: [ { \u0026#34;role\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;content\u0026#34;: \u0026#34;\u0026#34; } ], \u0026#34;temperature\u0026#34;: 1, \u0026#34;max_tokens\u0026#34;: 256, \u0026#34;top_p\u0026#34;: 1, \u0026#34;frequency_penalty\u0026#34;: 0, \u0026#34;presence_penalty\u0026#34;: 0 } Click on Import and then on Update connector. Click on Test \u0026gt; New connection and create a new connection for your connector. Enter your API key in the format \u0026ldquo;Bearer sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\u0026rdquo; (replace the x\u0026rsquo;s with your actual key). Enter a sample prompt and parameters in the Request body and click on Test operation. You should see a response that contains the generated text in the Response body. model: The ChatGPT model that you want to use, such as \u0026ldquo;gpt-3.5-turbo\u0026rdquo;. role: The role of the user, such as \u0026ldquo;system\u0026rdquo;. content: The prompt that you want to use, such as \u0026ldquo;Hello! How can I assist you today?\u0026rdquo;. Now copy the response body ,e.g. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 { \u0026#34;id\u0026#34;: \u0026#34;chatcmpl-83NuxzGRcPdDnA8eHFzYKTZc7ctSK\u0026#34;, \u0026#34;object\u0026#34;: \u0026#34;chat.completion\u0026#34;, \u0026#34;created\u0026#34;: 1695817615, \u0026#34;model\u0026#34;: \u0026#34;gpt-3.5-turbo-16k-0613\u0026#34;, \u0026#34;choices\u0026#34;: [ { \u0026#34;index\u0026#34;: 0, \u0026#34;message\u0026#34;: { \u0026#34;role\u0026#34;: \u0026#34;assistant\u0026#34;, \u0026#34;content\u0026#34;: \u0026#34;Hello! How can I assist you today?\u0026#34; }, \u0026#34;finish_reason\u0026#34;: \u0026#34;stop\u0026#34; } ], \u0026#34;usage\u0026#34;: { \u0026#34;prompt_tokens\u0026#34;: 9, \u0026#34;completion_tokens\u0026#34;: 9, \u0026#34;total_tokens\u0026#34;: 18 } } and go to the Definition tab. In the Response section, click on Add default response and click on \u0026ldquo;Import from Sample\u0026rdquo;. Enter the copied response body and click Import. This will bring the response body into the connector definition, which will allow you to use it in your app. Please update your connector and you are ready to go. How to test the custom connector in a canvas app? Now that you have set up your custom connector, you can test it in a canvas app. A canvas app is a type of app that you can build in PowerApps using a drag-and-drop interface. You can use canvas apps to create interactive and user-friendly apps that can run on any device.\nTo test the custom connector in a canvas app, follow these steps:\nGo to https://make.powerapps.com/ and sign in with your Microsoft account.\nIn the left navigation pane, click on Apps \u0026gt; + New app \u0026gt; Canvas.\nChoose a layout for your app, such as Tablet.\nIn the Insert tab, click on Text \u0026gt; Label and add a label to your app.\nIn the Properties tab, change the Text property of the label to the variable Name (e.g. Response).\nIn the Insert tab, click on Text \u0026gt; Text input and add a text input to your app.\nIn the Properties tab, change the Hint text property of the text input to \u0026ldquo;Enter your prompt here\u0026rdquo;.\nIn the Insert tab, click on Button and add a button to your app.\nIn the Properties tab, change the Text property of the button to \u0026ldquo;Generate\u0026rdquo;. In the Advanced tab, click on OnSelect and enter the following formula:\n1 2 3 4 5 6 7 8 9 10 11 12 Set( Response, ChatGPT.ChatGPT( { model: \u0026#34;gpt-3.5-turbo\u0026#34;, messages: { role: \u0026#34;system\u0026#34;, content: txt_search.Text } } ) ) Now you can test the App by entering a prompt in the text input and clicking on the button. The generated text will be displayed in the label. ","date":"2023-09-27T15:56:44+02:00","image":"https://www.menzel.it/post/2023/09/customconnectoropenai/Blog_custom-connector_hu0f1f440f2b9b7592a7416835c1d006cb_74818_120x120_fill_q75_box_smart1.jpeg","permalink":"https://www.menzel.it/post/2023/09/customconnectoropenai/","title":"How to create a Custom connector for OpenAI in PowerApps"},{"content":"In today\u0026rsquo;s rapidly evolving business landscape, collaboration and data-driven decision-making have become paramount. Microsoft\u0026rsquo;s Power Platform empowers organizations to create custom apps, automate workflows, and derive insights from data, all without requiring extensive coding skills. As businesses strive for greater efficiency and agility, the need to collaborate seamlessly within a secure environment has become crucial. One effective way to achieve this is by sharing Power Platform environments with security groups.\nSharing Power Platform Environments with Security Groups Sharing a Power Platform environment with a security group is a strategic approach that streamlines collaboration and enhances security. By associating users with specific security groups, administrators can ensure that the right people have access to the right resources, eliminating the complexities of individual user management. Here\u0026rsquo;s a step-by-step guide to sharing a Power Platform environment with a security group:\nStep 1: Set Up Security Groups Before sharing your Power Platform environment, establish security groups within your organization\u0026rsquo;s Entra ID (aka Azure Active Directory (AAD)). These groups can be based on roles, departments, projects, or any other relevant criteria. This step ensures that you can easily manage access permissions for a group of users instead of dealing with each user individually.\nStep 2: Access Environment Settings Within the Power Platform admin center, navigate to the environment you want to share. Open the environment settings, where you\u0026rsquo;ll find the \u0026ldquo;Access control\u0026rdquo; section. Step 3: Add Security Groups In the \u0026ldquo;Access control\u0026rdquo; section, you\u0026rsquo;ll see an Teams options to add security groups. There click on Create team. Select the Team Type \u0026ldquo;Microsoft Entra Identity Security Group\u0026rdquo; security group(s) you want to grant access to. This will grant all members of the security group access to the environment without the need for separate invitations. There you can also select the Membership type for the security group. This defines which part of your (Security) Group will get access. The access levels are:\nMembers and guests Members Owners Guests Fill out the other fields and click on Next. Step 4: Manage Security roles Power Platform provides various access levels, such as System Admin, Environment Maker, etc. Choose the appropriate access level for the security group members based on their responsibilities and requirements. Step 5: Save Changes After configuring the access settings, make sure to save your changes. The security group members will now be able to collaborate within the shared environment based on their assigned access levels.\nBenefits of Sharing with Security Groups 1. Streamlined Collaboration By sharing environments with security groups, organizations can optimize their resource allocation. Access to apps, data, and workflows can be controlled at a granular level, ensuring that users only have access to the resources they need. This reduces the risk of unauthorized data access or unintended modifications.\n3. Enhanced Security Security is a top priority in any digital workspace. Sharing environments with security groups enforces consistent access controls, reducing the chances of data breaches or unauthorized system changes. When a user\u0026rsquo;s role changes or they leave the organization, their access can be easily revoked by adjusting their security group membership.\n4. Scalability and Flexibility As organizations grow and evolve, their collaboration needs change as well. Sharing with security groups offers scalability and flexibility. New members can be added to security groups, granting them instant access to the appropriate resources. Additionally, security group memberships can be adjusted dynamically to accommodate changing team compositions.\n5. Simplified Administration Managing permissions for each user individually can be a time-consuming task. Sharing with security groups streamlines administration, as access settings are applied collectively to all group members. This frees up administrators to focus on more strategic tasks.\nIn conclusion, sharing a Power Platform environment with security groups is a smart strategy for enhancing collaboration, security, and efficiency. By leveraging this approach, organizations can streamline user management, optimize resource allocation, and foster a secure and productive digital workspace. As businesses continue to adapt to the demands of modern work, embracing collaborative solutions like Power Platform and security group sharing is a key step toward success.\n","date":"2023-08-21T11:37:23+02:00","image":"https://www.menzel.it/post/2023/08/environmentsecuritygroups/SCR-20230822-kbzs-2_hud6ea2a34c0340bef7f9049ba72ad4486_1269955_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/08/environmentsecuritygroups/","title":"Simplifying Collaboration: Sharing Power Platform Environments with Security Groups"},{"content":"Pre-requisites Before we get started, you\u0026rsquo;ll need to activate the preview feature \u0026ldquo;ParseJSON function and untyped objects\u0026rdquo; in your PowerApps settings. To do this, go to the Settings menu, browse to Upcoming features, and turn on the setting called ParseJSON function and untyped objects. If this feature is not turned on, the ParseJSON function will not be found in the formula bar. You need to add the Office365Groups connector to your PowerApps. To do this, go to the Data menu, and select Office 365 Groups. This will add the connector to your PowerApps. Using Office365Groups.HttpRequest The Office365Groups.HttpRequest allows you to make HTTP requests to external services from within your PowerApps. This can be useful when you want to retrieve data from an external source, such as the Graph API.\nHere\u0026rsquo;s an example of how you might use Office365Groups.HttpRequest to search for a message by its subject:\n1 Set(varRequestBody,\u0026#34;{\u0026#34;\u0026#34;requests\u0026#34;\u0026#34;: [{\u0026#34;\u0026#34;entityTypes\u0026#34;\u0026#34;: [\u0026#34;\u0026#34;message\u0026#34;\u0026#34;], \u0026#34;\u0026#34;query\u0026#34;\u0026#34;: {\u0026#34;\u0026#34;queryString\u0026#34;\u0026#34;: \u0026#34;\u0026#34;subject:Hello\u0026#34;\u0026#34;}}]}\u0026#34;); The code above sets a variable named varRequestBody. The JSON object contains a single property named requests .The object in the array represent the search request and contains two properties: entityTypes and query. The entityTypes property a string that specifies the type of entity to search for. In this case, the entity type specified is message (Email\u0026rsquo;s). The query property is an object that contains a single property named queryString. The queryString property is a string that specifies the search query to execute. In this case, the search query is subject:Hello.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 Set(varFile, \u0026#34;data:text/plain;base64,\u0026#34; \u0026amp; With({ InputText:varRequestBody, AsciiTable:AddColumns(Sequence(2^8,1),\u0026#34;char\u0026#34;,Char(Value)), B64ToBin: Table( {b64:\u0026#34;A\u0026#34;,bin:\u0026#34;000000\u0026#34;}, {b64:\u0026#34;B\u0026#34;,bin:\u0026#34;000001\u0026#34;}, {b64:\u0026#34;C\u0026#34;,bin:\u0026#34;000010\u0026#34;}, {b64:\u0026#34;D\u0026#34;,bin:\u0026#34;000011\u0026#34;}, {b64:\u0026#34;E\u0026#34;,bin:\u0026#34;000100\u0026#34;}, {b64:\u0026#34;F\u0026#34;,bin:\u0026#34;000101\u0026#34;}, {b64:\u0026#34;G\u0026#34;,bin:\u0026#34;000110\u0026#34;}, {b64:\u0026#34;H\u0026#34;,bin:\u0026#34;000111\u0026#34;}, {b64:\u0026#34;I\u0026#34;,bin:\u0026#34;001000\u0026#34;}, {b64:\u0026#34;J\u0026#34;,bin:\u0026#34;001001\u0026#34;}, {b64:\u0026#34;K\u0026#34;,bin:\u0026#34;001010\u0026#34;}, {b64:\u0026#34;L\u0026#34;,bin:\u0026#34;001011\u0026#34;}, {b64:\u0026#34;M\u0026#34;,bin:\u0026#34;001100\u0026#34;}, {b64:\u0026#34;N\u0026#34;,bin:\u0026#34;001101\u0026#34;}, {b64:\u0026#34;O\u0026#34;,bin:\u0026#34;001110\u0026#34;}, {b64:\u0026#34;P\u0026#34;,bin:\u0026#34;001111\u0026#34;}, {b64:\u0026#34;Q\u0026#34;,bin:\u0026#34;010000\u0026#34;}, {b64:\u0026#34;R\u0026#34;,bin:\u0026#34;010001\u0026#34;}, {b64:\u0026#34;S\u0026#34;,bin:\u0026#34;010010\u0026#34;}, {b64:\u0026#34;T\u0026#34;,bin:\u0026#34;010011\u0026#34;}, {b64:\u0026#34;U\u0026#34;,bin:\u0026#34;010100\u0026#34;}, {b64:\u0026#34;V\u0026#34;,bin:\u0026#34;010101\u0026#34;}, {b64:\u0026#34;W\u0026#34;,bin:\u0026#34;010110\u0026#34;}, {b64:\u0026#34;X\u0026#34;,bin:\u0026#34;010111\u0026#34;}, {b64:\u0026#34;Y\u0026#34;,bin:\u0026#34;011000\u0026#34;}, {b64:\u0026#34;Z\u0026#34;,bin:\u0026#34;011001\u0026#34;}, {b64:\u0026#34;a\u0026#34;,bin:\u0026#34;011010\u0026#34;}, {b64:\u0026#34;b\u0026#34;,bin:\u0026#34;011011\u0026#34;}, {b64:\u0026#34;c\u0026#34;,bin:\u0026#34;011100\u0026#34;}, {b64:\u0026#34;d\u0026#34;,bin:\u0026#34;011101\u0026#34;}, {b64:\u0026#34;e\u0026#34;,bin:\u0026#34;011110\u0026#34;}, {b64:\u0026#34;f\u0026#34;,bin:\u0026#34;011111\u0026#34;}, {b64:\u0026#34;g\u0026#34;,bin:\u0026#34;100000\u0026#34;}, {b64:\u0026#34;h\u0026#34;,bin:\u0026#34;100001\u0026#34;}, {b64:\u0026#34;i\u0026#34;,bin:\u0026#34;100010\u0026#34;}, {b64:\u0026#34;j\u0026#34;,bin:\u0026#34;100011\u0026#34;}, {b64:\u0026#34;k\u0026#34;,bin:\u0026#34;100100\u0026#34;}, {b64:\u0026#34;l\u0026#34;,bin:\u0026#34;100101\u0026#34;}, {b64:\u0026#34;m\u0026#34;,bin:\u0026#34;100110\u0026#34;}, {b64:\u0026#34;n\u0026#34;,bin:\u0026#34;100111\u0026#34;}, {b64:\u0026#34;o\u0026#34;,bin:\u0026#34;101000\u0026#34;}, {b64:\u0026#34;p\u0026#34;,bin:\u0026#34;101001\u0026#34;}, {b64:\u0026#34;q\u0026#34;,bin:\u0026#34;101010\u0026#34;}, {b64:\u0026#34;r\u0026#34;,bin:\u0026#34;101011\u0026#34;}, {b64:\u0026#34;s\u0026#34;,bin:\u0026#34;101100\u0026#34;}, {b64:\u0026#34;t\u0026#34;,bin:\u0026#34;101101\u0026#34;}, {b64:\u0026#34;u\u0026#34;,bin:\u0026#34;101110\u0026#34;}, {b64:\u0026#34;v\u0026#34;,bin:\u0026#34;101111\u0026#34;}, {b64:\u0026#34;w\u0026#34;,bin:\u0026#34;110000\u0026#34;}, {b64:\u0026#34;x\u0026#34;,bin:\u0026#34;110001\u0026#34;}, {b64:\u0026#34;y\u0026#34;,bin:\u0026#34;110010\u0026#34;}, {b64:\u0026#34;z\u0026#34;,bin:\u0026#34;110011\u0026#34;}, {b64:\u0026#34;0\u0026#34;,bin:\u0026#34;110100\u0026#34;}, {b64:\u0026#34;1\u0026#34;,bin:\u0026#34;110101\u0026#34;}, {b64:\u0026#34;2\u0026#34;,bin:\u0026#34;110110\u0026#34;}, {b64:\u0026#34;3\u0026#34;,bin:\u0026#34;110111\u0026#34;}, {b64:\u0026#34;4\u0026#34;,bin:\u0026#34;111000\u0026#34;}, {b64:\u0026#34;5\u0026#34;,bin:\u0026#34;111001\u0026#34;}, {b64:\u0026#34;6\u0026#34;,bin:\u0026#34;111010\u0026#34;}, {b64:\u0026#34;7\u0026#34;,bin:\u0026#34;111011\u0026#34;}, {b64:\u0026#34;8\u0026#34;,bin:\u0026#34;111100\u0026#34;}, {b64:\u0026#34;9\u0026#34;,bin:\u0026#34;111101\u0026#34;}, {b64:\u0026#34;+\u0026#34;,bin:\u0026#34;111110\u0026#34;}, {b64:\u0026#34;/\u0026#34;,bin:\u0026#34;111111\u0026#34;} )}, With({ BinRep: Concat( AddColumns(ForAll(Split(InputText,\u0026#34;\u0026#34;), {Result: ThisRecord.Value}),\u0026#34;dec\u0026#34;,LookUp(AsciiTable,char=Result).Value),//Convert text to Ascii character code (decimal) Concat(Sequence(8,8,-1),Text(If(And(Mod(dec,Power(2,Value))\u0026gt;=Power(2,Value-1),Mod(dec,Power(2,Value))\u0026lt;Power(2,Value)),1,0)))\u0026amp;\u0026#34;\u0026#34;,\u0026#34;\u0026#34;)//Convert decimal to binary }, With({b64string:Concat( Sequence( RoundUp(Len(BinRep)/6,0),0), LookUp( B64ToBin, bin=Mid(BinRep\u0026amp;Left(\u0026#34;000000\u0026#34;,6-Mod(Len(BinRep),6)),6*Value+1,6) //Left(\u0026#34;000000\u0026#34;....) is padding right with zero ).b64\u0026amp;\u0026#34;\u0026#34;, \u0026#34;\u0026#34; )}, b64string\u0026amp;Left(\u0026#34;====\u0026#34;,Mod(4-Mod(Len(b64string),4),4))//Convert binary to base64 ) ) )); This nice trick I learned from Hiro\u0026rsquo;s Blog - Encode plain text to Base64 - https://mofumofupower.hatenablog.com/entry/encode_decode The varRequestBody variable is then used to generate a Base64-encoded string that represents the request body for an HTTP request. This is done by first converting the varRequestBody variable to binary format, then to Base64 format. The resulting Base64 string is then used as the request body for the HTTP request.\n1 2 3 4 5 6 7 8 Set( varResult, Office365Groups.HttpRequest( \u0026#34;https://graph.microsoft.com/v1.0/search/query\u0026#34;, \u0026#34;POST\u0026#34;, varFile ) ) The HTTP request is sent to the Microsoft Graph API\u0026rsquo;s search endpoint (https://graph.microsoft.com/v1.0/search/query) using the Office365Groups.HttpRequest function. The function takes three arguments: the URL of the endpoint, the HTTP method to use (in this case, POST), and the request body to send with the request. This whole code can for example be put in a buttons OnSelect property to send the request when the button is clicked.\nShowing the Results in a Gallery Once we\u0026rsquo;ve made our HTTP request and retrieved the result, we can use a gallery to display the results. To do this, we\u0026rsquo;ll need to insert a gallery control to our App and set the Items property of the gallery to the following. To be able to work with those results, we need to get the resonse body from the HTTP request. This is done by doing one of the following:\nMake the same call in the Graph Explorer and exam the response body from there In PowerApps start the App - Monitor to get the response body from there 1 Table(Index(Table(Index(Table(varResult.value),1).Value.hitsContainers),1).Value.hits) The varResult variable is containing the response from the API. The response is expected to be a JSON object that contains a property named value. The value property is an array of objects that represent the search results.\nThe code uses the Table function to convert the varResult.value array to a table. The resulting table has a single column named Column1 that contains the search results. The Index function is then used to extract the first element of the Column1 array, which is another table. This table represents the hitsContainers property of the search results.\nThe Index function is used again to extract the first element of the hitsContainers table, which is another table. This table represents the hits property of the search results. Finally, the Table function is used again to convert the hits table to a table that can be displayed in the output pane of Visual Studio Code.\nNext, we\u0026rsquo;ll need to add a label control to the gallery and set its Text property to the following:\n1 ThisItem.Value.resource.subject In a gallery, each item is represented by a record that contains one or more fields. The ThisItem function is used to reference the current item in the gallery.\nIf we look at the output of the Table function, we can see that each item in the gallery is represented by a record that contains a resource field. The resource field is an object that contains a subject field.\nTherefore, ThisItem.Value.resource.subject is used to extract the subject of the resource from the current search result and display it in the label control.\nConclusion In this blog post, I\u0026rsquo;ve shown you how to use Graph API calls to Microsoft Search in PowerApps by using the Office365Groups.HttpRequest and the preview feature \u0026ldquo;ParseJSON function and untyped objects\u0026rdquo;. By following these steps, you\u0026rsquo;ll be able to retrieve data from external sources and use it within your PowerApps. We hope you found this post helpful! Let me know if you have any questions or comments.\nAdditional Resources Some links to more information about Microsoft Search and the Graph API:\nMicrosoft Graph Explorer - https://developer.microsoft.com/en-us/graph/graph-explorer Microsoft Graph API documentation - https://learn.microsoft.com/en-us/graph/search-concept-overview For testing / creating search queries:\nSharePoint Search Query Tool - https://github.com/pnp/PnP-Tools (Windows only) SP-Editor - Search Microsoft Edge Add-ons for it in the future as the Search part isn\u0026rsquo;t yet implemented in the meantime get the old Add-on from the Chrome Web Store (Windows, Mac, Linux) ","date":"2023-08-10T16:31:08+02:00","image":"https://www.menzel.it/post/2023/08/powerappssearchgraphapi/Article-Image_hu74736329785e2436b8b83e4f5d265e4e_297929_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/08/powerappssearchgraphapi/","title":"Using Graph API Calls to the Search Endpoint in PowerApps with Office365Groups.HttpRequest"},{"content":"Step-by-Step Explanation of the Code Here\u0026rsquo;s a step-by-step explanation of the PowerShell code for reconnecting pages with language variations after copying them with ShareGate:\nFirst, we need to connect to the SharePoint site where the pages are located. We can do this using the Connect-PnPOnline cmdlet: 1 Connect-PnPOnline -Url \u0026#34;https://contoso.sharepoint.com/sites/MySite\u0026#34; Next, we need to get a list of all the pages in the site. We can do this using the Get-PnPFolderItem cmdlet with the right language folder: 1 $Files = Get-PnPFolderItem -FolderSiteRelativeUrl SitePages/de This code gets a list of all the pages in the \u0026ldquo;Site Pages\u0026rdquo; language folder.\nNow that we have a list of all the pages, we need to loop through each page and reconnect its language variations. We can do this using a foreach loop: 1 2 3 foreach ($Page in $Pages) { # Reconnect language variations for the page } Inside the foreach loop, we need to get the default file for the page. We can do this using the Get-PnPFile cmdlet: 1 $DefaultFile = Get-PnPFile -Url \u0026#34;SitePages/$($Page.Name)\u0026#34; -AsListItem This code gets the default Page by using the Name property from the $Page object.\nNext, we need to get additional informations from the language variations of the page. We can do this using the Get-PnPListItem cmdlet: 1 $LangFile = Get-PnPFile -Url SitePages/$Language/$($Page.Name) -AsListItem This code gets a information about language variations page by filtering the pages in the \u0026ldquo;Site Pages\u0026rdquo; library by Folder $Language-Variable and the $Page.Name.\nNow that we have all the information we need, we can reconnect the language variations to the default file. We can do this using the Set-PnPListItem cmdlet: 1 2 #Set the Default Item field Set-PnPListItem -List SitePages -Identity $DefaultFile.Id -Values @{\u0026#34;_SPTranslatedLanguages\u0026#34; = $LangISO} 1 2 #Set the Language Item fields Set-PnPListItem -List SitePages -Identity $LangFile.Id -Values @{\u0026#39;_SPIsTranslation\u0026#39; = \u0026#39;1\u0026#39;; \u0026#39;_SPTranslationLanguage\u0026#39; = $LangISO; \u0026#39;_SPTranslationSourceItemId\u0026#39; = $DefaultFile.FieldValues.UniqueId } This code sets the _SPTranslationSourceItemId property of the variation file to the GUID of the default file.\nThat\u0026rsquo;s it! We\u0026rsquo;ve now looped through all the pages and their language variations, and reconnected them to each other. Conclusion In this blog post, we\u0026rsquo;ve walked through the PowerShell code for reconnecting pages with language variations after copying them with ShareGate. By using this code, you can ensure that the language variations are properly connected to each other, and that they are displayed correctly on the site.\nHere\u0026rsquo;s the complete PowerShell script for reconnecting pages with language variations after copying them with ShareGate:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $SiteCollection = \u0026#34;https://contoso.sharepoint.com/sites/SiteCollection\u0026#34; $Language = \u0026#34;de\u0026#34; $LangISO = \u0026#34;de-de\u0026#34; #Create Connection Connect-PnPOnline -Url $SiteCollection -Interactive #Get all aspx pages within Folder DE in Library SitePages $Pages = Get-PnPFolderItem -FolderSiteRelativeUrl SitePages/$Language #Loop through all files and get the file object from the files with the same name in the root directory foreach ($Page in $Pages) { $DefaultFile = Get-PnPFile -Url SitePages/$($Page.Name) -AsListItem $LangFile = Get-PnPFile -Url SitePages/$Language/$($Page.Name) -AsListItem #Set the Default Item field Set-PnPListItem -List SitePages -Identity $DefaultFile.Id -Values @{\u0026#34;_SPTranslatedLanguages\u0026#34; = $LangISO} #Set the German Language Item fields Set-PnPListItem -List SitePages -Identity $LangFile.Id -Values @{\u0026#39;_SPIsTranslation\u0026#39; = \u0026#39;1\u0026#39;; \u0026#39;_SPTranslationLanguage\u0026#39; = $LangISO; \u0026#39;_SPTranslationSourceItemId\u0026#39; = $DefaultFile.FieldValues.UniqueId } } ","date":"2023-07-27T11:57:41+02:00","image":"https://www.menzel.it/post/2023/07/reconnect_pages/Reconnect_hu58e59d2a09840853c5e0830e43305ea7_1183462_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/07/reconnect_pages/","title":"Reconnecting Pages with Language Variations After Copying Them with ShareGate"},{"content":"Add to OneDrive: Easy File Access Add to OneDrive lets you bring shared files into your personal OneDrive space without moving them physically. Simply locate the desired folder, select the Folders tile, and choose \u0026ldquo;Add Shortcut to My Files.\u0026rdquo; This creates a shortcut for quick access.\nThis feature is particularly useful for accessing files across devices related to collaborative projects. It provides centralized access regardless of your location, improving efficiency and reducing clicks.\nTeam Site Sync: Comprehensive File Synchronization Team Site Sync also allows you syncing files from OneDrive, SharePoint, and Teams.\nTeam Site Sync syncs specific folders or libraries, but it is limited to the device where synchronization occurred.\nChoosing Between Add to OneDrive and Team Site Sync For most scenarios, Add to OneDrive is recommended due to its enhanced capabilities and future development. If your organization isn\u0026rsquo;t extensively using Team Site Sync, it\u0026rsquo;s advisable to prioritize Add to OneDrive exclusively.\nIf your organization currently employs both features, Microsoft plans to provide guidance on migrating from Team Site Sync to Add to OneDrive gradually.\nDisabling the Sync Button To streamline the file synchronization experience and promote Add to OneDrive, you can disable the sync button for the entire site using the following code:\n1 Set-SPOTenant -HideSyncButtonOnTeamSite $true This script helps IT administrators guide users towards Add to OneDrive and encourages its adoption.\n","date":"2023-05-16T16:38:45+02:00","image":"https://www.menzel.it/post/2023/05/add_to_onedrive/Main_hu502c155179e040f10273bd58ace348bd_299354_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/05/add_to_onedrive/","title":"Simplifying File Management with OneDrive: Add to OneDrive vs. Team Site Sync"},{"content":"Steps to Disable Sharing for Non-Owners Open the SharePoint Online site where you want to disable sharing for non-owners. Click on the gear icon in the top right corner and select \u0026ldquo;Site Settings\u0026rdquo;. Under \u0026ldquo;Site Permissions\u0026rdquo;, click on \u0026ldquo;Advanced permission settings\u0026rdquo;. In the ribbon choose the \u0026ldquo;Access Request Settings\u0026rdquo;. Uncheck \u0026ldquo;Allow members to share the site and individual files and folders\u0026rdquo; to restrict sharing permissions for non-owners of a document. That\u0026rsquo;s it! Now you know how to disable sharing for non-owners in SharePoint Online. If you have any questions or comments, please leave them below. ","date":"2023-05-11T00:00:00Z","image":"https://www.menzel.it/post/2023/05/disable_sharing/Microsoft365-Logo_huc751c11c8412c46ecd89393641f090d6_5832667_120x120_fill_box_smart1_3.png","permalink":"https://www.menzel.it/post/2023/05/disable_sharing/","title":"How to Disable Sharing for Non-Owners in SharePoint Online"}]